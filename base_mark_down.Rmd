---
title: "Daily Step Counts"
author: "Karen, Anastasiia, Linda, Asuman, Narod"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(knitr)
library(LearnBayes)
source('TeachBayes.r')
library(tidyverse)
```

## Prior

We're interested in estimating the average steps of a graduate student per day and how it differs between female and male students. 

Prior parameters $\mu_0,\sigma_0$ are calculated based on previous [research studies](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7093766/) which have been tracked via investigators from the National Cancer Institute (NCI) and the National Institute on Aging (NIA).

```{r}
# define our prior data set that is collected from previous publications
prior_data_set <- c(3800, 4000, 3000, 4000, 8000, 11822,8000, 7500, 9999, 10000, 12499)

# plot a histogram
hist(prior_data_set)

# set mu_0 and sigma_0 based on prior data
# as we have the average daily step counts, we calculate standard deviation
mu0 <- mean(prior_data_set)
sd0 <- sd(prior_data_set)

# sample size
n <- length(prior_data_set)

```
## Data collection 

We observed average daily step counts of a small group of graduate students

a. Store the $k=21$ properties as a vector of average daily step counts in an `R` object called `steps_per_day` 
b. Calculate the mean of average steps per day and then compute the standard error using $\sigma$ and $k$

```{r}
steps_per_day <- c(400, 1000, 1500, 6000, 7016, 7820, 8000, 8000, 8000, 8068, 10000, 10000, 10414, 10953, 11124, 12417, 14000, 14000, 14000, 15000, NA)

k <- length(steps_per_day)

xbar <- mean(steps_per_day, na.rm = TRUE)
sigma <- 4780 # for known $\sigma$ of an ith student 
se <- sigma/sqrt(k)
```

## Posterior

```{r}
## Calculate shape parameters for beta posterior:
post_mean <- normal_update(c(mu0,sd0), c(xbar,se))[1]
post_sd <- normal_update(c(mu0,sd0), c(xbar,se))[2]

df <- data.frame(Distribution = c("Prior","Data","Posterior"), 
                 Mean = c(mu0, xbar, post_mean), 
                 SD = c(sd0, se, post_sd))
df
```

Plot the prior, data and posterior

```{r}
x <- seq(min(prior_data_set), max(prior_data_set), by=3000)

priorx <- dnorm(x, mean=mu0, sd=sd0)
datax  <- dnorm(x, mean=xbar, sd=se)
postx  <- dnorm(x, mean=post_mean, sd=post_sd)

plot(x, priorx, type='l', lwd=3, xlim=c(min(x), max(x)), ylim=c(0,0.0004), col='blue', 
     main = '', xlab = 'theta', ylab = '')
lines(x, datax, col='black', lwd=3)
lines(x, postx, col='red', lwd=3)

legend("topright", c("Prior","Data","Posterior"), lty = 1, lwd= 3, col = c('blue','black','red'))
```
**The posterior is overlapped with the data**

```{r}


```

